
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shift Calendar with Leave, Holidays & Weekend Rotation</title>
  <style>
    body { font-family: Arial; background: #f4f4f4; padding: 20px; }
    header { background: #fff; padding: 10px 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); margin-bottom: 20px; }
    .controls { text-align: center; margin-bottom: 10px; }
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 10px;
      max-width: 1000px;
      margin: auto;
      background: white;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .day {
      background: #e9eff5;
      padding: 10px;
      border-radius: 6px;
      min-height: 100px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .header {
      background: #2a4d69;
      color: white;
      text-align: center;
      padding: 10px;
      border-radius: 6px;
      font-weight: bold;
    }
    .shift { font-size: 12px; margin-top: 5px; cursor: pointer; }
    .leave { color: red; font-weight: bold; }
    .off { color: gray; font-style: italic; }
    .holiday {
      background-color: #ffe0b2;
      position: relative;
    }
    .holiday:hover::after {
      content: attr(data-holiday);
      position: absolute;
      background: #444;
      color: white;
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 4px;
      top: 0;
      left: 0;
      white-space: nowrap;
      z-index: 99;
    }
  </style>
</head>
<body>
<div id="login-screen" style="display:none;" style="text-align:center; margin-top:100px;">
  <h2>Login to Shift Calendar</h2>
  <select id="login-user">
    <option value="">-- Select User --</option>
    <option value="Venkatrao Srinu">Venkatrao Srinu</option>
    <option value="Ruksar">Ruksar</option>
    <option value="Nagarjun">Nagarjun</option>
    <option value="Kiruthika">Kiruthika</option>
  </select>
  <br><br>
  <div id="password-box" style="display:none;">
    <input type="password" id="lead-password" placeholder="Enter password for lead" />
    <br><br>
  </div>
  <button onclick="login()">Login</button>
</div>
<script>
function getUserFromURL() {
  const params = new URLSearchParams(window.location.search);
  return params.get("user") || "";
}
document.addEventListener("DOMContentLoaded", function () {
  const user = getUserFromURL();
  if (user) {
    localStorage.setItem("loggedInUser", user);
    document.getElementById("app").style.display = "block";
    document.getElementById("user").value = user;
    if (user !== "Venkatrao Srinu") {
      document.getElementById("editBtn").style.display = "none";
    }
    generateCalendar();
  } else {
    document.body.innerHTML = "<h2 style='text-align:center;'>User not recognized. Please open with ?user=YourName in URL.</h2>";
  }
});

  document.getElementById("login-user").addEventListener("change", function() {
  const selected = this.value;
  document.getElementById("password-box").style.display = selected === "Venkatrao Srinu" ? "block" : "none";
});

function login() {
  const user = document.getElementById("login-user").value;
  const password = document.getElementById("lead-password").value;

  if (!user) return alert("Please select a user.");
  if (user === "Venkatrao Srinu" && password !== "devops123") {
    return alert("Incorrect password for Team Lead.");
  }
    const user = document.getElementById("login-user").value;
    if (!user) return alert("Please select a user.");
    localStorage.setItem("loggedInUser", user);
    
    document.getElementById("app").style.display = "block";
    document.getElementById("user").value = user;
    if (user !== "Venkatrao Srinu") {
      document.getElementById("editBtn").style.display = "none";
    }
  }

  window.onload = () => {
    const savedUser = localStorage.getItem("loggedInUser");
    if (savedUser) {
      
      document.getElementById("app").style.display = "block";
      document.getElementById("user").value = savedUser;
      if (savedUser !== "Venkatrao Srinu") {
        document.getElementById("editBtn").style.display = "none";
      }
    }
  }
</script>

  <header>
  <img src="data:image/webp;base64,UklGRrQBAABXRUJQVlA4WAoAAAAQAAAAEwAAEwAAQUxQSGgAAAARP3D7/4iIbbiKJFloZngI2OVFWHDAc8Dz/5t4iOh/Xg0tsgchAPcAC/AdokruAUTMmlULrFl+70NSgHXZBskatQFYpwDQ9UEg8AwAovsgJZE9SDDkGQI0PKfESPeUStt3kjbad/ZvAVZQOCAmAQAAEAcAnQEqFAAUAD6RKKRSJaGlpZQAsBIJbACxHzQwMLUvSd5VNUBWxforUAP0zDr2HZtvJ8VKxUl1LITbuN50KSAA9mDdOtflYmi9U4GnFnLuazOTMTDrZ6JulS+rCL1pUrcUnV9wnX9uGnkjalzPQs/97x5CjQy3Lk8Er4hnd/4R6p5YaIE72Gv/w04vzH0Z8yq3l0NHsvtFpftlpRu2FffGYif/ylp9GezkY4tFnh1sEZAp7dDtT0tg785gf7d//RKBbuY/y7GXt+iVGR45mbod8Wp73zFUqfiIT8HC3tdz6+6IyRFyxt569wb9txFq41kaKmofKH/0Ajj3sIZMFArQWTm4MMKeRgAi4gPXiK77YLfWtxZfKmDBTOcsHGWW4ASayIAA" alt="Company Logo" style="height: 50px; margin-right: 10px;">
  <h2 style="margin: 0;">Information Dynamics India Pvt Ltd - Shift Calendar</h2>
  </header>
  <div id="app" style="display:none;"><div class="controls">
    <label>Logged in as:
      <select id="user">
        <option value="Venkatrao Srinu">Venkatrao Srinu (Lead)</option>
        <option value="Ruksar">Ruksar</option>
        <option value="Nagarjun">Nagarjun</option>
        <option value="Kiruthika">Kiruthika</option>
      </select>
    </label>
    <select id="month"></select>
    <select id="year"></select>
    <button onclick="generateCalendar()">Generate Calendar</button>
    <button onclick="toggleEditMode()">Enable Edit Mode</button>
  </div>

  <div class="calendar" id="calendar"></div>

  <script>
function getUserFromURL() {
  const params = new URLSearchParams(window.location.search);
  return params.get("user") || "";
}
document.addEventListener("DOMContentLoaded", function () {
  const user = getUserFromURL();
  if (user) {
    localStorage.setItem("loggedInUser", user);
    document.getElementById("app").style.display = "block";
    document.getElementById("user").value = user;
    if (user !== "Venkatrao Srinu") {
      document.getElementById("editBtn").style.display = "none";
    }
    generateCalendar();
  } else {
    document.body.innerHTML = "<h2 style='text-align:center;'>User not recognized. Please open with ?user=YourName in URL.</h2>";
  }
});

    const calendar = document.getElementById("calendar");
    const userSelect = document.getElementById("user");
    const lead = "Venkatrao Srinu";
    const members = ["Nagarjun", "Kiruthika", "Ruksar"];
    const shiftTimes = {
      lead: "09:30 - 18:30",
      shiftA: "07:00 - 16:00",
      shiftB: "12:00 - 21:00"
    };
    let rotation = [...members];
    let weekendIndex = 0;
    let editMode = false;
    const holidays = {
  "2025-01-01": "New Year",
  "2025-01-14": "Pongal",
  "2025-01-15": "Thiruvalluvar Day",
  "2025-01-26": "Republic Day",
  "2025-03-31": "Ramzan",
  "2025-05-01": "May Day",
  "2025-08-15": "Independence Day",
  "2025-08-27": "Vinayakar Chathurthi",
  "2025-10-01": "Ayutha Pooja",
  "2025-10-02": "Gandhi Jayanthi",
  "2025-10-20": "Deepavali",
  "2025-12-25": "Christmas"
};

    function toggleEditMode() {
      if (userSelect.value !== lead) {
        alert("Only the Team Lead can enable edit mode.");
        return;
      }
      editMode = !editMode;
      alert(editMode ? "Edit Mode Enabled." : "Edit Mode Disabled.");
    }

    function populateSelectors() {
      const now = new Date();
      const monthSel = document.getElementById("month");
      const yearSel = document.getElementById("year");
      const months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
      months.forEach((m, i) => {
        let opt = document.createElement("option");
        opt.value = i; opt.text = m;
        if (i === now.getMonth()) opt.selected = true;
        monthSel.appendChild(opt);
      });
      for (let y = 2024; y <= 2030; y++) {
        let opt = document.createElement("option");
        opt.value = y; opt.text = y;
        if (y === now.getFullYear()) opt.selected = true;
        yearSel.appendChild(opt);
      }
    }

    function generateCalendar() {
      calendar.innerHTML = "";
      ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"].forEach(d => {
        const div = document.createElement("div");
        div.className = "header";
        div.textContent = d;
        calendar.appendChild(div);
      });

      const month = parseInt(document.getElementById("month").value);
      const year = parseInt(document.getElementById("year").value);
      const start = new Date(year, month, 1);
      const end = new Date(year, month + 1, 0);
      const offset = (start.getDay() + 6) % 7;
      rotation = [...members];
      let leaveData = JSON.parse(localStorage.getItem("leaveData") || "{}");

      for (let i = 0; i < offset; i++) {
        let empty = document.createElement("div");
        empty.className = "day";
        calendar.appendChild(empty);
      }

      const weekendOrder = ["Nagarjun", "Kiruthika", "Ruksar"]; let currentWeekendWorker = weekendOrder[weekendIndex % weekendOrder.length];

      for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) {
        const dateStr = `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
        const weekday = (d.getDay() + 6) % 7;
        const shifts = [];

        if (weekday === 3 || weekday === 4) {
          // Thu, Fri – Lead works, 2 members work, 1 OFF (weekend worker)
          shifts.push(`${lead}: ${shiftTimes.lead}`);
          const working = members.filter(m => m !== currentWeekendWorker);
          shifts.push(`${working[0]}: ${shiftTimes.shiftA}`);
          shifts.push(`${working[1]}: ${shiftTimes.shiftB}`);
          shifts.push(`${currentWeekendWorker}: OFF`);
        } else if (weekday === 5 || weekday === 6) {
          // Sat, Sun – assign weekend person work
          shifts.push(`${currentWeekendWorker}: ${shiftTimes.lead}`);
          if (weekday === 6) {
            weekendIndex++;
            currentWeekendWorker = members[weekendIndex % members.length];
          }
        } else {
          shifts.push(`${lead}: ${shiftTimes.lead}`);
          const [a, b1, b2] = [rotation[0], rotation[1], rotation[2]];
          if (weekday < 3) {
            shifts.push(`${a}: ${shiftTimes.shiftA}`);
            shifts.push(`${b1}: ${shiftTimes.shiftB}`);
            shifts.push(`${b2}: ${shiftTimes.shiftB}`);
          } else {
            shifts.push(`${b1}: ${shiftTimes.shiftB}`);
            shifts.push(`${b2}: ${shiftTimes.shiftB}`);
          }
        }

        const box = document.createElement("div");
        box.className = "day";
        if (holidays[dateStr]) {
          box.classList.add("holiday");
          box.setAttribute("data-holiday", holidays[dateStr]);
        }
        box.innerHTML = `<h3>${d.getDate()}</h3>`;
        shifts.forEach(s => {
          const div = document.createElement("div");
          div.className = "shift";
          const name = s.split(":")[0];
          if (s.includes("OFF")) div.classList.add("off");
          const leaveMarked = leaveData[dateStr]?.includes(name);
          div.textContent = leaveMarked ? `${name}: Leave` : s;
          if (leaveMarked) div.classList.add("leave");
          div.addEventListener("click", () => {
            if (!editMode || userSelect.value !== lead) return;
            leaveData[dateStr] = leaveData[dateStr] || [];
            const idx = leaveData[dateStr].indexOf(name);
            if (idx >= 0) leaveData[dateStr].splice(idx, 1);
            else leaveData[dateStr].push(name);
            localStorage.setItem("leaveData", JSON.stringify(leaveData));
            generateCalendar();
          });
          box.appendChild(div);
        });
        calendar.appendChild(box);
      }
    }

    populateSelectors();
    generateCalendar();
  </script>
</div></body>
</html>
